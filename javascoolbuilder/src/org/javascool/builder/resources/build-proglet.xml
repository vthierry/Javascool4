<?xml version="1.0" encoding="UTF-8"?>
<project name="javascool-${proglet.name}" default="default" basedir=".">
    <description>Builds, tests, and runs the project Java's Cool Core.</description>
    
    <target name="default">
        <mkdir dir="${proglet.doc}" />
        <copy todir="${proglet.doc}">
            <fileset dir=".">
                <include name="*.xml" />
                <exclude name="build.xml" />
            </fileset>
        </copy>
        <xslt basedir="${proglet.doc}" destdir="${proglet.doc}" extension=".htm" style="${jvs.hdocxslt}">
            <include name="${proglet.doc}/  *.xml"/>
            <classpath location="${jvs.saxon}" />
        </xslt><!-- Bah non, on cenvertit en htm ou en html, pas les deux !
        <xslt destdir="${proglet.doc}" extension=".html" style="${jvs.hdocxslt}">
            <include name="*/*.xml"/>
            <classpath location="${jvs.saxon}" />
        </xslt>-->
        <copy todir=".">
            <fileset dir="${proglet.doc}">
                <exclude name="**/*.xml"/>
            </fileset>
        </copy>
        <delete dir="${proglet.doc}"/>
        <delete dir="${proglet.src}"/>
        <mkdir dir="${proglet.build}"/>
        <mkdir dir="${proglet.src}"/>
        <mkdir dir="${jvs.tojar.tmp}"/>
        <copy todir="${proglet.src}">
            <fileset dir="."/>
        </copy>
        <javac srcdir="${proglet.src}" destdir="${proglet.build}" includeantruntime="false" classpath="${jvs.basejar}">
        </javac>
        <copy todir="${proglet.build}">
            <fileset dir="${proglet.src}"/>
        </copy>
        <mkdir dir="${proglet.build}/src" />
        <move todir="${proglet.build}/src">
            <fileset dir="${proglet.build}">
                <include name="*.java" />
                <include name="*.xml" />
                <exclude name="build.xml" />
            </fileset>
        </move>
        
        <delete file="${proglet.build}/build.xml"/>
        <delete file="${proglet.build}/build.htm"/>
        
        <mkdir dir="${jvs.tojar.tmp}/org/javascool/proglets/${proglet.name}"/>
        <copy todir="${jvs.tojar.tmp}/org/javascool/proglets/${proglet.name}">
            <fileset dir="${proglet.build}">
                <exclude name="org/"/>
            </fileset>
        </copy>
        <copy todir="${jvs.tojar.tmp}/org/javascool/proglets/${proglet.name}">
            <fileset dir="${proglet.build}/org/javascool/proglets/${proglet.name}">
            </fileset>
        </copy>
        
        <delete dir="${proglet.src}"/>
        <delete dir="${proglet-build}"/>
    </target>
</project>