<!-- Construction des éléments de javascool (core), javascoolbuilder, et des proglets -->
<project>
  <!-- On utilise http://ant-contrib.sourceforge.net/tasks/tasks/index.html pour un meilleur interface -->
  <taskdef resource="net/sf/antcontrib/antlib.xml"/>

  <property name="build.dir" value="../tags/build"/>
  <property name="classpath" value="lib/jvs2html.jar"/>

  <target name="test">
    <for param="file">
      <outofdate>
        <sourcefiles>
          <fileset dir="jvs-old/proglet" includes="**/*.xml"/>
        </sourcefiles>
        <mapper dir="jvs-old/proglet" type="glob" from="*.xml" to="jvs-old/proglet/*.htm"/>
      </outofdate>
      <sequential>
        <propertyregex override="yes" property="file" input="@{file}" regexp=".*/([^\.]*)\.xml" replace="\1"/>
        <echo>Need to generate a target html file from source file ${file} from @{file}</echo>
      </sequential>
    </for>
  </target>
  
  <target name="classes">
    <mkdir dir="${build.dir}/classes"/>
    <javac deprecation="true" classpath="${classpath}" srcdir="src" destdir="${build.dir}/classes"/>
  </target>
  
  <target name="javascool.jar" depends="classes" >
    <mkdir dir="${build.dir}/jar"/>
    <jar destfile="../tags/javascool.jar" basedir="${build.dir}/classes">
      <manifest>
        <attribute name="Main-Class" value="org.javascool.Core"/>
      </manifest>
    </jar>
    <exec executable="sh">
      <arg value="-c"/>
      <arg value="ls -l ../tags/javascool.jar"/>
    </exec>
  </target>

  <target name="javadoc">
    <mkdir dir="${build.dir}/web/api"/>
    <javadoc
      classpath="${classpath}"
      access="public" 
      destdir="${build.dir}/web/api"
      windowtitle="Java's Cool v4"
      doctitle="Java's Cool v4"
      author="true"
      version="true"
      use="true"  
      nodeprecated="true"
      nohelp="true"
      nonavbar="true"
      notree="true"
      charset="UTF-8"
       >
      <link href="http://download.oracle.com/javase/6/docs/api"/>
      <link href="http://javadoc.fifesoft.com/rsyntaxtextarea"/>
      <fileset dir="src" defaultexcludes="yes">
        <include name="**/*.java"/>
      </fileset>
    </javadoc>
  </target>

  <target name="run" depends="javascool.jar">
    <java jar="../tags/javascool.jar" fork="true"/>
  </target>
  
  <target name="clean">
    <delete dir="${build.dir}"/>
  </target>
    
</project>
